{"version":3,"file":"reindexnode.element-DMQBLkN4.js","sources":["../../Our.Umbraco.FullTextSearch.Client/src/modals/reindexnode.element.ts"],"sourcesContent":["import { html, LitElement, property, customElement, state } from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\r\nimport type { UmbModalContext } from \"@umbraco-cms/backoffice/modal\";\r\nimport { UmbModalExtensionElement } from \"@umbraco-cms/backoffice/extension-registry\";\r\nimport { ReindexNodeModalData } from \"./reindexnode.modaltoken.ts\";\r\nimport { UUIButtonState } from \"@umbraco-cms/backoffice/external/uui\";\r\nimport FullTextSearchContext, { FULLTEXTSEARCH_CONTEXT_TOKEN } from \"../context/fulltextsearch.context.ts\";\r\nimport { UMB_NOTIFICATION_CONTEXT, UmbNotificationContext } from \"@umbraco-cms/backoffice/notification\";\r\n\r\n@customElement('our-umbraco-fulltext-search-reindex-node-modal')\r\nexport default class ReindexNodeDialogElement\r\n    extends UmbElementMixin(LitElement)\r\n    implements UmbModalExtensionElement<ReindexNodeModalData> {\r\n    \r\n    #notificationContext?: UmbNotificationContext;\r\n    #fullTextSearchContext?: FullTextSearchContext;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.consumeContext(FULLTEXTSEARCH_CONTEXT_TOKEN, (fullTextSearchContext) => {\r\n            this.#fullTextSearchContext = fullTextSearchContext;\r\n        })\r\n\r\n        this.consumeContext(UMB_NOTIFICATION_CONTEXT, (instance) => {\r\n            this.#notificationContext = instance;\r\n        });\r\n    }\r\n\r\n    @property({ attribute: false })\r\n    modalContext?: UmbModalContext<ReindexNodeModalData>;\r\n\r\n    @property({ attribute: false })\r\n    data?: ReindexNodeModalData;\r\n\r\n    @state()\r\n    private _withDescendantsState: UUIButtonState;\r\n\r\n    @state()\r\n    private _withoutDescendantsState: UUIButtonState;\r\n\r\n    private _handleCancel() {\r\n        this.modalContext?.submit();\r\n    }\r\n\r\n    private async _reindex(includeDescendants: boolean) {\r\n        if (!this.modalContext) return;\r\n\r\n        this.modalContext?.submit();\r\n\r\n        const reindexingNotification = this.#notificationContext?.stay('default', {\r\n            data: {\r\n                headline: this.localize.term(`fullTextSearch_reindexing`),\r\n                message: this.localize.term(`fullTextSearch_reindexingMessage`)\r\n            }\r\n        });\r\n\r\n        await this.#fullTextSearchContext?.reindex(includeDescendants, this.modalContext?.data.unique?.toString());\r\n        \r\n        reindexingNotification?.close();\r\n\r\n        this.#notificationContext?.peek('positive', {\r\n            data: {\r\n                headline: this.localize.term(`fullTextSearch_reindexed`),\r\n                message: this.localize.term(`fullTextSearch_reindexedMessage`)\r\n            }\r\n        });\r\n    }\r\n\r\n    override render() {\r\n        return html`\r\n            <uui-dialog-layout headline=\"${this.localize.term(this.modalContext?.data.unique ? `fullTextSearch_reindexNode` : `fullTextSearch_reindexAllNodes`)}\">\r\n                ${(this.modalContext?.data.unique\r\n                ? html`\r\n                    <uui-button look=\"primary\" .state=${this._withoutDescendantsState} @click=${() => this._reindex(false)}>\r\n                        <umb-localize key=\"fullTextSearch_reindexJustThisNode\">\r\n                            Reindex just this node\r\n                        </umb-localize></uui-button>\r\n                    <uui-button look=\"secondary\" .state=${this._withDescendantsState} @click=${() => this._reindex(true)}>\r\n                        <umb-localize key=\"fullTextSearch_reindexWithDescendants\">\r\n                            Reindex with descendants\r\n                        </umb-localize>\r\n                    </uui-button>\r\n                ` : html`\r\n                    <uui-button look=\"primary\" .state=${this._withDescendantsState} @click=${() => this._reindex(true)}>\r\n                        <umb-localize key=\"fullTextSearch_reindexAllContent\">\r\n                            Reindex all content\r\n                        </umb-localize></uui-button>\r\n                `)}\r\n                <uui-button @click=${this._handleCancel}>\r\n                    <umb-localize key=\"general_cancel\">\r\n                        Cancel\r\n                    </umb-localize>\r\n                </uui-button>\r\n            </uui-dialog-layout>\r\n        `;\r\n    }\r\n}"],"names":["_notificationContext","_fullTextSearchContext","ReindexNodeDialogElement","UmbElementMixin","LitElement","__privateAdd","FULLTEXTSEARCH_CONTEXT_TOKEN","fullTextSearchContext","__privateSet","UMB_NOTIFICATION_CONTEXT","instance","_a","includeDescendants","reindexingNotification","_b","__privateGet","_e","_d","_c","_f","html","__decorateClass","property","state","customElement"],"mappings":";;;;;;;;;;gUAAAA,GAAAC;AAUA,IAAqBC,IAArB,cACYC,EAAgBC,CAAU,EACwB;AAAA,EAK1D,cAAc;AACJ,aAJVC,EAAA,MAAAL,CAAA,GACAK,EAAA,MAAAJ,CAAA,GAKS,KAAA,eAAeK,GAA8B,CAACC,MAA0B;AACzE,MAAAC,EAAA,MAAKP,GAAyBM,CAAA;AAAA,IAAA,CACjC,GAEI,KAAA,eAAeE,GAA0B,CAACC,MAAa;AACxD,MAAAF,EAAA,MAAKR,GAAuBU,CAAA;AAAA,IAAA,CAC/B;AAAA,EACL;AAAA,EAcQ,gBAAgB;;AACpB,KAAAC,IAAA,KAAK,iBAAL,QAAAA,EAAmB;AAAA,EACvB;AAAA,EAEA,MAAc,SAASC,GAA6B;;AAC5C,QAAA,CAAC,KAAK,aAAc;AAExB,KAAAD,IAAA,KAAK,iBAAL,QAAAA,EAAmB;AAEnB,UAAME,KAAyBC,IAAAC,EAAA,MAAKf,CAAsB,MAA3B,gBAAAc,EAA2B,KAAK,WAAW;AAAA,MACtE,MAAM;AAAA,QACF,UAAU,KAAK,SAAS,KAAK,2BAA2B;AAAA,QACxD,SAAS,KAAK,SAAS,KAAK,kCAAkC;AAAA,MAClE;AAAA,IAAA;AAGE,YAAAE,IAAAD,EAAA,MAAKd,OAAL,gBAAAe,EAA6B,QAAQJ,IAAoBK,KAAAC,IAAA,KAAK,iBAAL,gBAAAA,EAAmB,KAAK,WAAxB,gBAAAD,EAAgC,cAE/FJ,KAAA,QAAAA,EAAwB,UAEnBM,IAAAJ,EAAA,MAAAf,CAAA,MAAA,QAAAmB,EAAsB,KAAK,YAAY;AAAA,MACxC,MAAM;AAAA,QACF,UAAU,KAAK,SAAS,KAAK,0BAA0B;AAAA,QACvD,SAAS,KAAK,SAAS,KAAK,iCAAiC;AAAA,MACjE;AAAA,IAAA;AAAA,EAER;AAAA,EAES,SAAS;;AACP,WAAAC;AAAA,2CAC4B,KAAK,SAAS,MAAKT,IAAA,KAAK,iBAAL,QAAAA,EAAmB,KAAK,SAAS,+BAA+B,gCAAgC,CAAC;AAAA,mBAC5IG,IAAA,KAAK,iBAAL,QAAAA,EAAmB,KAAK,SACzBM;AAAA,wDACsC,KAAK,wBAAwB,WAAW,MAAM,KAAK,SAAS,EAAK,CAAC;AAAA;AAAA;AAAA;AAAA,0DAIhE,KAAK,qBAAqB,WAAW,MAAM,KAAK,SAAS,EAAI,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA,oBAKpGA;AAAA,wDACoC,KAAK,qBAAqB,WAAW,MAAM,KAAK,SAAS,EAAI,CAAC;AAAA;AAAA;AAAA;AAAA,iBAIpG;AAAA,qCACmB,KAAK,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOnD;AACJ;AAnFIpB,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AAeAoB,EAAA;AAAA,EADCC,EAAS,EAAE,WAAW,IAAO;AAAA,GAnBbpB,EAoBjB,WAAA,gBAAA,CAAA;AAGAmB,EAAA;AAAA,EADCC,EAAS,EAAE,WAAW,IAAO;AAAA,GAtBbpB,EAuBjB,WAAA,QAAA,CAAA;AAGQmB,EAAA;AAAA,EADPE,EAAM;AAAA,GAzBUrB,EA0BT,WAAA,yBAAA,CAAA;AAGAmB,EAAA;AAAA,EADPE,EAAM;AAAA,GA5BUrB,EA6BT,WAAA,4BAAA,CAAA;AA7BSA,IAArBmB,EAAA;AAAA,EADCG,EAAc,gDAAgD;AAAA,GAC1CtB,CAAA;"}
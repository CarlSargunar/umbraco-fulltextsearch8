{"version":3,"file":"assets.js","sources":["../../Our.Umbraco.FullTextSearch.Client/src/actions/entity/manifest.ts","../../Our.Umbraco.FullTextSearch.Client/src/modals/manifest.ts","../../Our.Umbraco.FullTextSearch.Client/src/index.ts","../../Our.Umbraco.FullTextSearch.Client/src/modals/reindexnode.modaltoken.ts","../../Our.Umbraco.FullTextSearch.Client/src/actions/entity/reindex.action.ts","../../Our.Umbraco.FullTextSearch.Client/src/modals/reindexnode.element.ts"],"sourcesContent":["import { UMB_DOCUMENT_ENTITY_TYPE, UMB_DOCUMENT_DETAIL_REPOSITORY_ALIAS, UMB_DOCUMENT_ROOT_ENTITY_TYPE } from \"@umbraco-cms/backoffice/document\";\r\nimport { ManifestEntityAction } from \"@umbraco-cms/backoffice/extension-registry\";\r\n\r\nconst entityAction: ManifestEntityAction = {\r\n    type: 'entityAction',\r\n    kind: 'default',\r\n    alias: 'our.umbraco.fulltextsearch.reindex.action',\r\n    name: 'ReindexNode',\r\n    weight: -100,\r\n    forEntityTypes: [UMB_DOCUMENT_ROOT_ENTITY_TYPE, UMB_DOCUMENT_ENTITY_TYPE],\r\n    api: () => import('./reindex.action.ts'),\r\n    elementName: 'our-umbraco-fulltext-search-actions-entity-reindexnode',\r\n    meta: {\r\n        icon: 'icon-alarm-clock',\r\n        label: '#fulltextsearch_reindex',\r\n        repositoryAlias: UMB_DOCUMENT_DETAIL_REPOSITORY_ALIAS,\r\n    }\r\n}\r\n\r\nexport const manifests = [entityAction];\r\n","import { ManifestModal } from \"@umbraco-cms/backoffice/extension-registry\";\r\n\r\nconst reIndexNodeModal: ManifestModal = {\r\n    type: 'modal',\r\n    alias: 'our.umbraco.fulltextsearch.modals.reindexnode',\r\n    name: 'Reindex node',\r\n    js: () => import('./reindexnode.element.ts'),\r\n}\r\n\r\nexport const manifests = [reIndexNodeModal];\r\n","import { UmbEntryPointOnInit } from '@umbraco-cms/backoffice/extension-api';\r\nimport { UMB_AUTH_CONTEXT } from '@umbraco-cms/backoffice/auth';\r\nimport { manifests as entityActionManifests } from './actions/entity/manifest.ts';\r\nimport { manifests as modalManifests } from './modals/manifest.ts';\r\n\r\nexport const onInit: UmbEntryPointOnInit = (_host, extensionRegistry) => {\r\n\r\n    // register them here. \r\n    extensionRegistry.registerMany([\r\n        ...entityActionManifests,\r\n        ...modalManifests\r\n    ]);\r\n\r\n    _host.consumeContext(UMB_AUTH_CONTEXT, (_auth) => {\r\n        // const umbOpenApi = _auth.getOpenApiConfiguration();\r\n        // OpenAPI.TOKEN = umbOpenApi.token;\r\n        // OpenAPI.BASE = umbOpenApi.base;\r\n        // OpenAPI.WITH_CREDENTIALS = umbOpenApi.withCredentials;\r\n    });\r\n\r\n};","import { UmbEntityUnique } from \"@umbraco-cms/backoffice/entity\";\r\nimport { UmbModalToken } from \"@umbraco-cms/backoffice/modal\";\r\n\r\nexport type ReindexNodeModalData = {\r\n    unique: UmbEntityUnique;\r\n}\r\n\r\nexport const REINDEX_NODE_MODAL_TOKEN = new UmbModalToken<ReindexNodeModalData>('our.umbraco.fulltextsearch.modals.reindexnode', {\r\n    modal: {\r\n        type: 'dialog',\r\n        size: 'small'\r\n    }\r\n});","import { UmbControllerHostElement } from \"@umbraco-cms/backoffice/controller-api\";\r\n//import { UmbDocumentItemRepository } from \"@umbraco-cms/backoffice/document\";\r\nimport { UmbEntityActionArgs, UmbEntityActionBase } from \"@umbraco-cms/backoffice/entity-action\";\r\nimport { UMB_MODAL_MANAGER_CONTEXT } from '@umbraco-cms/backoffice/modal';\r\nimport { REINDEX_NODE_MODAL_TOKEN } from \"../../modals/reindexnode.modaltoken\";\r\n\r\nexport class ReindexNodeAction extends UmbEntityActionBase<never> {\r\n    #modalManagerContext?: typeof UMB_MODAL_MANAGER_CONTEXT.TYPE;\r\n\r\n\r\n    constructor(host: UmbControllerHostElement, args: UmbEntityActionArgs<never>) {\r\n        super(host, args)\r\n\r\n        this.consumeContext(UMB_MODAL_MANAGER_CONTEXT, (instance) => {\r\n            this.#modalManagerContext = instance;\r\n        });\r\n    }\r\n\r\n    async execute() {\r\n        const modalContext = this.#modalManagerContext?.open(this, REINDEX_NODE_MODAL_TOKEN, {\r\n            data: {\r\n                unique: this.args.unique\r\n            }\r\n        });\r\n\r\n        await modalContext?.onSubmit().then(() => {\r\n            console.log(\"ok\")\r\n        }).catch(() => {\r\n            console.log(\"no\")\r\n        });\r\n    }\r\n\r\n};\r\n\r\nexport default ReindexNodeAction;","import { html, LitElement, property, customElement, state } from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\r\nimport type { UmbModalContext } from \"@umbraco-cms/backoffice/modal\";\r\nimport { UmbModalExtensionElement } from \"@umbraco-cms/backoffice/extension-registry\";\r\nimport { ReindexNodeModalData, ReindexNodeModalValue } from \"./reindexnode.modaltoken.ts\";\r\nimport { UUIButtonState } from \"@umbraco-cms/backoffice/external/uui\";\r\n\r\n@customElement('our-umbraco-fulltext-search-reindex-node-modal')\r\nexport default class ReindexNodeDialogElement\r\n    extends UmbElementMixin(LitElement)\r\n    implements UmbModalExtensionElement<ReindexNodeModalData> {\r\n\r\n    @property({ attribute: false })\r\n    modalContext?: UmbModalContext<ReindexNodeModalData>;\r\n\r\n    @property({ attribute: false })\r\n    data?: ReindexNodeModalData;\r\n\r\n    @state()\r\n    private _withDescendantsState: UUIButtonState;\r\n\r\n    @state()\r\n    private _withoutDescendantsState: UUIButtonState;\r\n\r\n    private _handleCancel() {\r\n        this.modalContext?.submit();\r\n    }\r\n\r\n    private _reindex(includeDescendants: boolean) {\r\n        this._setButtonState(includeDescendants, 'waiting');\r\n\r\n        console.log(\"reindexing\", includeDescendants);\r\n    }\r\n\r\n    private _setButtonState(includeDescendants: boolean, state: UUIButtonState) {\r\n        if (includeDescendants) {\r\n            this._withDescendantsState = state;\r\n        }\r\n        else {\r\n            this._withoutDescendantsState = state;\r\n        }\r\n    }\r\n\r\n    override render() {\r\n        return html`\r\n            <uui-dialog-layout headline=\"Reindex ${(this.data?.unique ? `node` : `all content`)}\">\r\n                ${(this.data?.unique\r\n                ? html`\r\n                    <uui-button look=\"primary\" .state=${this._withoutDescendantsState} @click=${() => this._reindex(false)}>Reindex just this node</uui-button>\r\n                    <uui-button look=\"secondary\" .state=${this._withDescendantsState} @click=${() => this._reindex(true)}>Reindex with descendants</uui-button>\r\n                ` : html`\r\n                    <uui-button look=\"primary\" .state=${this._withDescendantsState} @click=${() => this._reindex(true)}>Reindex all nodes</uui-button>\r\n                `)}\r\n                <uui-button @click=${this._handleCancel}>Cancel</uui-button>\r\n            </uui-dialog-layout>\r\n        `;\r\n    }\r\n}"],"names":["entityAction","UMB_DOCUMENT_ROOT_ENTITY_TYPE","UMB_DOCUMENT_ENTITY_TYPE","reindex_action","UMB_DOCUMENT_DETAIL_REPOSITORY_ALIAS","manifests","reIndexNodeModal","reindexnode_element","onInit","_host","extensionRegistry","entityActionManifests","modalManifests","UMB_AUTH_CONTEXT","_auth","REINDEX_NODE_MODAL_TOKEN","UmbModalToken","ReindexNodeAction","UmbEntityActionBase","host","args","__privateAdd","_modalManagerContext","UMB_MODAL_MANAGER_CONTEXT","instance","__privateSet","modalContext","_a","__privateGet","ReindexNodeDialogElement","UmbElementMixin","LitElement","includeDescendants","state","html","_b","__decorateClass","property","customElement"],"mappings":"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"}